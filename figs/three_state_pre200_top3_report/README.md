# Three-state pre200 report (Top neurons & pre-touch)

This folder was generated by `three_state_top3_and_pretouch_plots.py`.

## States definition
- **State 0**: 200s before reunion (mouse alone, no other mouse, no touch).
- **State 1**: After reunion but **outside** any social-touch bouts (other mouse present, no touch).
- **State 2**: Social-touch bouts (as labeled by Excel “社交开始/社交结束”).

Neural features were z-scored and lightly smoothed, then averaged in 1s bins for a multinomial logistic regression.
The model provides a weight vector for each state; neurons with larger |β| contribute more strongly to classifying that state.

## Figures

### state0_top3_activity.png
Top 3 representative neurons for **State 0** (ranked by |β_state0|).
Shown as activity traces over the extended epoch (time relative to reunion).
Background light shading indicates **touch periods (State 2)** for reference.

Selected neurons:
- neuron 11  β_state0 = -0.4410
- neuron 84  β_state0 = -0.4279
- neuron 50  β_state0 = -0.4262

### state1_top3_activity.png
Top 3 representative neurons for **State 1** (ranked by |β_state1|).
Shown as activity traces over the extended epoch (time relative to reunion).
Background light shading indicates **touch periods (State 2)** for reference.

Selected neurons:
- neuron 82  β_state1 = +1.0675
- neuron 112  β_state1 = -1.0453
- neuron 30  β_state1 = -0.9764

### state2_top3_activity.png
Top 3 representative neurons for **State 2** (ranked by |β_state2|).
Shown as activity traces over the extended epoch (time relative to reunion).
Background light shading indicates **touch periods (State 2)** for reference.

Selected neurons:
- neuron 82  β_state2 = -1.1285
- neuron 112  β_state2 = +1.0907
- neuron 64  β_state2 = +0.9185

### reunion_pretouch_timeline.png
A compact timeline of the extended epoch with three-state labels.
- Dashed vertical lines: **touch onset** (each “社交开始”).
- Light shaded blocks: **pre-touch windows** defined as the *5 seconds before each touch onset*.
This helps visualize where state1 (no-touch) transitions into state2 (touch) around each bout.

## Files
- `three_state_glm_outputs.npz`: saved model weights, epoch data, and labels for reproducibility.
- `README.md`: this description.