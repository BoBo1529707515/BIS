# Need_z(t) 一维动力学的模型比较与状态数扫描

本文件夹由脚本 `社交需求_一维HMM_状态数扫描_模型比较.py` 自动生成，
用于在一维社交需求指数 Need_z(t) 上，系统比较不同统计模型及不同隐状态数 K 的拟合效果。

## 一、模型概述

本分析中考虑的模型包括：

1. **Gaussian(iid)**：
   - 假设所有时间点独立同分布，来自同一个高斯分布 N(μ, σ²)。

2. **AR(1)**：
   - 单一连续动力学状态：x_t = a · x_{t-1} + ε_t。
   - 允许时间上的一阶记忆，但不考虑多隐状态切换。

3. **GMM-K (K = 1..4)**：
   - 仅考虑 Need_z 的静态分布，由 K 个高斯分布的混合组成；
   - 不考虑时间顺序和状态切换，仅反映“分布是否多峰”。

4. **HMM-Gaussian-K (K = 1..4)**：
   - 带时间结构的模型：存在 K 个隐状态 z_t ∈ {1..K}；
   - 每个状态下观测值服从不同的高斯分布，并通过转移矩阵在状态之间切换。

后续若需要，还可以在此基础上进一步实现 HMM-AR 模型（每个隐状态对应不同的 AR(1) 动力学），
本脚本目前先聚焦在 Gaussian / AR(1) / GMM / HMM-Gaussian 这一组模型上。

## 二、模型比较结果（loglik / AIC / BIC）

各模型的 log-likelihood、AIC 和 BIC 统计如下（具体数值请以实际输出为准）：

- **Gaussian_iid**
  - 类型: Gaussian(iid)
  - loglik = -12417.13
  - AIC = 24838.26
  - BIC = 24852.42

- **AR1_single_state**
  - 类型: AR(1)
  - loglik = 11849.32
  - AIC = -23694.64
  - BIC = -23680.49

- **GMM_K1**
  - 类型: GMM
  - 状态数 / 成分数 K = 1
  - loglik = -12417.13
  - AIC = 24838.26
  - BIC = 24852.42

- **GMM_K2**
  - 类型: GMM
  - 状态数 / 成分数 K = 2
  - loglik = -11419.84
  - AIC = 22849.69
  - BIC = 22885.07

- **GMM_K3**
  - 类型: GMM
  - 状态数 / 成分数 K = 3
  - loglik = -11210.08
  - AIC = 22436.16
  - BIC = 22492.78

- **GMM_K4**
  - 类型: GMM
  - 状态数 / 成分数 K = 4
  - loglik = -11229.62
  - AIC = 22481.24
  - BIC = 22559.08

- **HMM_Gaussian_K1**
  - 类型: HMM-Gaussian
  - 状态数 / 成分数 K = 1
  - loglik = -12417.13
  - AIC = 24838.26
  - BIC = 24852.42

- **HMM_Gaussian_K2**
  - 类型: HMM-Gaussian
  - 状态数 / 成分数 K = 2
  - loglik = -8409.53
  - AIC = 16833.06
  - BIC = 16882.59

- **HMM_Gaussian_K3**
  - 类型: HMM-Gaussian
  - 状态数 / 成分数 K = 3
  - loglik = -8409.52
  - AIC = 16847.05
  - BIC = 16946.12

- **HMM_Gaussian_K4**
  - 类型: HMM-Gaussian
  - 状态数 / 成分数 K = 4
  - loglik = -2031.33
  - AIC = 4108.66
  - BIC = 4271.43


一般来说：
- **AIC / BIC 数值越小，模型在考虑参数复杂度后对数据的解释越好；**
- 若 HMM-Gaussian-K 相比 GMM-K 显著降低 BIC，说明时间结构（状态切换）对数据是必要的；
- 若 GMM-K 或 HMM-K 在 K=2 或 3 时 BIC 最优，则支持“存在 2–3 个隐状态/峰值”的解释；
- 若 AR(1) 的 BIC 比所有 HMM/GMM 模型都低，则说明一维连续动力学已经足够解释 Need_z。

## 三、AIC / BIC 图像

- model_compare_AIC.png：按模型名称排列的 AIC 柱状图；
- model_compare_BIC.png：按模型名称排列的 BIC 柱状图。

可以通过观察哪些模型在 AIC/BIC 上最小，来判断：
- 是否需要多隐状态（K>1）；
- 若需要，多隐状态模型中 K=2 是否已经足够，或是否存在 K=3/4 更优的可能；
- HMM 是否比静态的 GMM 更适合描述 Need_z(t) 的结构。

## 四、如何理解“到底有几个状态”？

如果比较结果显示：
- GMM-K 在 K=2 时 BIC 显著低于 K=1，但 K>2 又没有明显改善；
- HMM-Gaussian-2 的 BIC 明显低于 HMM-1（即单状态高斯）、同时不输给 K=3/4；
则可以认为 Need_z(t) 在统计上更像是由两个隐状态/模式生成的，而不是单一均匀状态。

此时，再结合前面 HMM 分解得到的：
- 不同状态下 Need_z 的均值差异（低 vs 高需求）；
- 各自的时间常数 τ（快恢复 vs 慢恢复）；
- 与行为标签（独处/无触摸/触摸）的对齐关系；
就可以比较有信心地解释这两个隐状态为：
- 一个是长期存在的低需求 / 基线状态；
- 一个是由持续社交接触渐渐积累、并维持较长时间的高需求 / 激活状态。
