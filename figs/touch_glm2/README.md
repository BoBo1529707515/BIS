# 二状态 GLM2：社交 vs 非社交（touch_glm2）结果说明

本文件夹保存的是 **二状态 GLM（touch_glm2）** 的分析结果，  
主要用于回答：在重聚后这段时间里，哪些 mPFC 神经元最擅长区分  
“**社交触摸**（social touch）” 和 “**非社交**（no-touch）”。

---

## 一、模型与状态定义

在 **重聚之后** 的时间段中（直到最后一次社交结束，并加少量缓冲）：

- 将每一秒的时间 bin 标记为两类：
  - **社交触摸（touch, y=1）**：这一秒中大部分时间处于 Excel 标注的  
    “社交开始 / 社交结束” 区间内；
  - **非社交（no-touch, y=0）**：重聚后但当前不在任何社交触摸区间内。

- 对每个神经元的 Ca 活动做：
  - z-score 归一化；
  - 按 1 s bin 求平均，作为二分类 GLM 的输入特征。

使用二项式 logistic 回归（GLM2）拟合：

\[
P(\text{touch} | \text{activity}) = \sigma(\beta_0 + \sum_j \beta_j x_j)
\]

其中：

- \(\beta_j\) 是第 \(j\) 个神经元的权重；
- \(|\beta_j|\) 越大，说明该神经元在区分“社交 vs 非社交”时贡献越大；
- \(\beta_j > 0\)：活动高 → 更倾向判为 **社交触摸（pro-touch）**；
- \(\beta_j < 0\)：活动高 → 更倾向判为 **非社交/no-touch（anti-touch）**。

---

## 二、关键结果文件：`beta_motor_top_neurons_ranking.csv`

**文件作用：**

- 给出所有神经元在二状态 GLM 中的 **权重排序表**，
  对应我们常说的“**动机轴 / 社交轴 β_motor**”。

**内容说明（列含义）：**

具体列名可在 CSV 中查看，一般包括：

- 每个神经元的 **编号**（neuron index）；
- 对应的 **β_motor 权重**（社交 vs 非社交的 GLM 系数）；
- 以及相关的绝对值与排序信息（例如 |β_motor|、rank 等）。

**排序方式：**

- 通常按 `|β_motor|` 从大到小排序：
  - 排在前面的神经元，对“社交 vs 非社交”的判别最关键；
  - 后面的神经元在这个二元任务里贡献较小。

**如何解读：**

- β_motor 为 **正且绝对值大**：
  - 这类神经元在社交触摸期活动明显升高；
  - 是 **pro-social / pro-touch** 类型的候选细胞。

- β_motor 为 **负且绝对值大**：
  - 这类神经元在非社交 / no-touch 期活动更高，
    或在触摸期间被抑制；
  - 是 **anti-touch / pro-no-touch** 类型的候选细胞。

这张表后续被用来：

- 选取 **Top 神经元** 进行单细胞时间轨迹绘图（例如 neuron 82, 112, 30 等）；
- 构建整体的 **社交动机维度（β_motor 轴）**；
- 与三状态 GLM、PSTH、社交需求指数等分析结果进行交叉验证。

---

## 三、其他图像文件（如已生成）

若运行对应绘图脚本（例如 `主导分类神经元绘图.py` 等），  
本文件夹中还可能包含若干 PNG 图像，例如：

- **Top 神经元权重条形图**：显示按 |β_motor| 排名前几位神经元的权重大小与正负；
- **代表性神经元的时间轨迹图**：在重聚 epoch 内，叠加社交触摸时间段，展示
  pro-touch / anti-touch 神经元在行为中的具体活动模式。

这些图像都以 `beta_motor_top_neurons_ranking.csv` 为基础，
用于更加直观地展示二状态 GLM2 的主要发现。
